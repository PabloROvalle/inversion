subroutine convol_jwst(n_rad,radiance,fwhm,n_fnu,fnu,nflux,wave,synthetic)

  implicit none

  integer :: i, j, k
  integer, intent(in) ::  n_fnu,nflux, n_rad

  real, intent(in) :: fwhm
  real, dimension(n_rad), intent(in) :: radiance
  real, dimension(n_fnu) :: fnu, aux
  real, dimension(nflux), intent(in) :: wave
  real, dimension(nflux), intent(out) :: synthetic
!------------------------------------------------------------------------------
  do i=1, nflux
     where (abs(fnu - wave(i)) < 3*fwhm)
        aux = 2**(-((fnu-wave(i))/fwhm)**2)
     elsewhere
        aux = 0.
     end where
     synthetic(i) = sum(radiance*aux) / sum(aux)
  enddo

  return
end subroutine convol_jwst
